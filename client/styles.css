:root {
  color-scheme: light dark;

  --toolheight: 6rem;
  --itemheight: calc(var(--toolheight) - 0.9rem);
  --statusheight: 1.25rem;
  --rulerheight: 1.25rem;
  --purple2: light-dark(#e5c4ff, #650191);
  --purple: #b78fd8;
  --font: unifont; /* Hack, "Courier New", Courier, monospace */
  --fontsize: 14px;

  --top: 0.2rem;

  --background: light-dark(#d1d1d1, #454545);
  --secondary: light-dark(#6d6d6d, #ababab);
  --background-gradient: light-dark(#ababab, rgb(87, 87, 87));
}

@font-face {
  font-family: unifont;
  src: url("../fonts/unifont-16.0.04.otf");
}

* {
  margin: 0;
  padding: 0;
  overflow: hidden;
  font-size: var(--fontsize);
  font-family: var(--font);
}

/* TODO Need to change some things to allow consistent viewing across different screen sizes like phone, 
regular size monitor, wide/ultra wide */
body {
  height: 100svh;
  width: 100svw;
  background: linear-gradient(
    135deg,
    var(--background) 0%,
    var(--background-gradient) 100%
  );
}

.cursor {
  width: 10px;
  height: 10px;
  background-color: var(--secondary);
  position: absolute;
  border: 1px black solid;
}

/* main top UI  */
#toolbar {
  /* width: 100svw; */
  height: var(--toolheight);
  overflow: visible;
  display: flex;
  justify-content: space-between;
  /* align-items: center; */
  margin-top: -0.3rem;
  /* margin-left: .1rem; */
  z-index: 100;
}

#toolbar-left {
  /* width: 100svw; */
  position: relative;
  overflow-x: auto; /* make it scroll horizontally */
  overflow-y: hidden;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior-x: contain;
  touch-action: pan-x;
  height: var(--toolheight);
  overflow: visible;
  display: flex;
  /* margin-left: -0.4rem; */
  align-items: center;
  flex-wrap: nowrap; /* keeper */
  margin-left: 0.05rem;
  gap: 0.1rem;
  z-index: 101;
}

#toolbar-right {
  /* width: 100svw; */
  height: var(--toolheight);
  overflow: visible;
  display: flex;
  /* justify-content: space-between; */
  /* margin-left: -0.4rem; */
  margin-right: 0.3rem;
  align-items: center;
}

#toolbar button.active {
  background-color: var(--secondary);
  /* box-shadow: 0px 0px 1px 1px var(--purple); */
}

#toolbar button svg.active {
  fill: var(--background);
}

/* in the name: drawing area */
#drawingarea {
  width: 100svw;
  height: calc(
    100svh - var(--toolheight) - var(--rulerheight) - var(--statusheight)
  );
  touch-action: none; /* for screen users */
  grid-column: 2 / 3;
  grid-row: 2 / 3;
}

canvas {
  image-rendering: pixelated;
  image-rendering: crisp-edges;
}

#myCanvas {
  cursor: none;
}

/* For the color pickers === primary/secondary/userColorPicker */
input[type="color"] {
  -webkit-appearance: none;
  appearance: none;
  width: 6rem;
  height: 6rem;
  border: 1px transparent;
  margin-top: 1px;
  margin-right: -0.25rem;

  /* border-radius: 1px black; */

  background-color: transparent;
}

#userColorPicker {
  border: none;
  border-radius: 0%;
  width: 5rem;
  height: 5rem;

  /* aspect-ratio: 1;
  appearance: none;
  padding: 0; */
}

#userColorPicker::-webkit-color-swatch-wrapper {
  padding: 0; /* remove default inset */
  border-radius: 50% 50%;
}
#userColorPicker::-webkit-color-swatch {
  border: none;
  border-radius: 50% 50%; /* swatch circle */
}

#userColorPicker::-moz-color-swatch {
  border: none;
  border-radius: 50% 50%;
}

#userListWrapper {
  position: relative;
  display: inline-block;
  overflow: visible;
}

#userListToggle {
  /*carrot on toolbar*/
  cursor: pointer;
  padding-top: 0.6rem;
  fill: var(--secondary);
}

#userListToggle svg {
  transition: transform 0.01s ease;
  transform-origin: center center; /* rotate around its center */
}

/* when the toggle has the “open” class, flip the arrow */
#userListToggle.open svg {
  transform: rotate(180deg);
}

/* Figure out a way later to change this to be flexible and dynamic for ultimate customization */
#userList {
  position: fixed;
  list-style: none;
  width: max-content;
  min-width: 29.6ch;
  max-width: min(90ch, 90vw);
  overflow-wrap: anywhere;

  max-height: 50vh; /* never grow taller than the viewport */
  overflow-y: auto; /* and show a scrollbar when it does  */
  overscroll-behavior: contain;

  top: 100%;
  left: auto;
  right: 0;
  list-style: none;
  margin: 0;
  padding: 0;
  background: var(--background);
  border: 1px solid gray;

  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);

  cursor: move;
  z-index: 90;
}

#userList li {
  padding: 4px 8px;
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: var(--fontsize);
  font-family: var(--font);
}

#userList li span {
  white-space: normal;
}

#userList .username {
  font-family: monospace;
  line-height: 1;
}

/* single-line names (span) should wrap anywhere if too long */
#userList span.username {
  white-space: normal; /* allow wrapping                */
  overflow-wrap: anywhere; /* break even inside “ssssss…”   */
}

/* ASCII art (pre) keeps exact layout, scrolls horizontally if too wide */
#userList pre.username {
  white-space: pre; /* preserve spaces + \n          */
  overflow-x: auto; /* let user scroll long rows     */
}

.user-color-indicator {
  /* keep the browser from resizing or adding its own bevel */
  appearance: none; /* modern */
  -webkit-appearance: none; /* Safari/Chrome */
  -moz-appearance: none; /* Firefox */

  /* force a fixed square */
  width: 1rem;
  height: 1rem; /* add this line */
  flex: 0 0 1rem; /* don’t let flexbox distort it */

  border: 1px black solid;
  padding: 0;
  border-radius: 50% 50%;
  box-sizing: border-box; /* include any borders in the 1 rem box */
}

.user-color-indicator::-webkit-color-swatch-wrapper {
  padding: 0;
  border-radius: 50% 50%;
}

.user-color-indicator::-webkit-color-swatch {
  border: none;
  border-radius: 50% 50%;
}
.user-color-indicator::-moz-color-swatch {
  border: none;
  border-radius: 50% 50%;
}

.hidden {
  display: none;
}

#customInputUsernameBox {
  /* background-color: var(--background); */
  /* height: var(--itemheight); */
  height: var(--itemheight);
  background-color: transparent;

  color: var(--secondary);
  /* border: var(--secondary) 2px solid; */
  border: transparent 2px solid;
  /* border: red 1px solid; */
  /* padding-left: 0.5rem; */
  text-align: left;
}

.custom-dropdown-username-box {
  font-size: var(--fontsize);
  font-family: var(--font);
  /* padding: 2px 4px; */
  width: 10rem;
  height: var(--itemheight);
  margin-left: 0.3rem;
  /* margin-right: 2rem; */
  /* margin-right: .3rem; */
  text-align: left;
  border: 1px transparent solid;
  position: relative;
}

.custom-dropdown-username-box input {
  width: 100%;
  /* margin-top: 0.1rem; */

  border: var(--secondary) 2px solid;
  font-size: var(--fontsize);
  font-family: var(--font);
  outline: none;
  transition: none;
  appearance: none;
  text-align: center; /* Center-align text for consistent positioning */
  background-image: none;
  background-repeat: no-repeat;
}

#customInputBrushsizeBox {
  /* background-color: var(--background); */
  /* height: var(--itemheight); */
  height: var(--itemheight);
  background-color: transparent;

  color: var(--secondary);
  /* border: var(--secondary) 2px solid; */
  border: transparent 2px solid;
  /* border: red 1px solid; */
  padding-left: 0.5rem;
  text-align: left;
}

.custom-dropdown-brushsize-box {
  position: relative;
  display: inline-block;
  /* height: var(--itemheight); */
  /* width: 175px; */
  width: 10.5rem;

  /* margin-right: 17.5px; */
  /* margin-right: 8.5px; */
  overflow: visible;
  background-color: transparent;
  color: var(--secondary);
}

/* Input field with dynamic brush size preview */
/* Input field with brush size preview on the right */
.custom-dropdown-brushsize-box input {
  width: 100%;
  margin-top: 0.1rem;

  border: var(--secondary) 2px solid;
  font-size: var(--fontsize);
  font-family: var(--font);
  outline: none;
  transition: none;
  appearance: none;
  text-align: center; /* Center-align text for consistent positioning */
  background-image: none;
  background-repeat: no-repeat;
}

.custom-dropdown-brushsize-box input::selection {
  background-color: var(--purple);
}

/* Ensure no change on focus */
.custom-dropdown-brushsize-box input:focus {
  border: 1px solid var(--secondary);
  /* box-shadow: inset 0 0 0 1px #ffffff; */ /* box-shadow: 0 0 10px 2px #ddc6f0;; Prevent focus shadow */
  outline: none; /* Prevent focus outline */
  transition: none; /* Ensure no visual transition */
  align-items: center;
}

/* Dropdown list styling */
.actual-dropdown-list-brushsize-box {
  display: none; /* Hidden by default */
  position: absolute;
  /* top: 100%;  */
  /* width: 100%; */

  width: 150px;
  /* border-top: 1px solid var(--secondary);
  border-left: 1px solid var(--secondary);
  border-right: 1px solid var(--secondary);
  border-bottom: 1px solid var(--secondary); */
  /* left: 0.7rem; */
  /* padding-right: 12px; */

  background-color: var(--background);

  margin: 0;
  list-style: none;
  z-index: 70; /* LUL */
}

.actual-dropdown-list-brushsize-box.show {
  display: block;
}

.dropdown-item {
  display: flex; /* Align text and line horizontally */
  align-items: center;
  justify-content: start; /* Space between the number and the line preview */
  /* justify-content: space-evenly; */
  padding-top: 8px;
  padding-bottom: 8px;
  padding-right: 0px;
  padding-left: 5px;
  font-family: var(--font); /* Match input font */
  font-size: 14px;
  cursor: pointer;
  height: calc(var(--toolheight) / 4); /* Ensure consistent height */
  width: 10.1rem;
}

.dropdown-item:hover {
  background-color: var(--purple2);
}
.dropdown-item:active {
  background-color: var(--purple);
}

.size-label {
  text-align: center; /* Align numbers in dropdown */
  margin-right: 12px; /* Space between label and line preview */
  width: 20px; /* Fixed width for numbers, handles up to 3 digits */
}

.size-line {
  background-color: var(--secondary); /* Line color */
  display: inline-block;
  /* margin-left: 3px; */
  width: 114px; /* Consistent width for all line previews */
}

#main-tools {
  display: grid;
  grid-template-columns: repeat(2, 1.5rem);
  grid-template-rows: repeat(3, 1.5rem);
  gap: 0.3rem;
  align-items: center;
  justify-content: center;
  /* margin: auto 1rem; */

  /* margin-left: 0.25rem;
  padding-top: var(--top); */
  /* margin-right: -.2rem; super debateable option right here no kizzy no cappy */
  z-index: 80;
  overflow: visible;
}

#fillTool,
#pencil,
#undo,
#redo,
#eraser,
#straightLine {
  /* display: flex; */
  align-items: center;
  justify-content: center;
  cursor: pointer;
  position: relative;

  width: 1.7rem;
  height: 1.7rem;
  /* padding: 1px;
  margin-top: 0.2rem;
  margin-right: 0.25em;
  margin-left: 0.25em; */

  /* border: var(--secondary) 2px solid; */
  background-color: transparent;
  border: transparent 2px solid;
}

#fillTool svg,
#pencil svg,
#undo svg,
#redo svg,
#eraser svg,
#straightLine svg {
  /* margin: auto; */
  width: 20px;
  height: 20px;
  /* color: red;
  fill: red; */
  fill: var(--secondary);
}

#fillTool:hover,
#pencil:hover,
#undo:hover,
#redo:hover,
#eraser:hover,
#straightLine:hover {
  background-color: var(--purple2);
}

#fillTool:active,
#pencil:active,
#undo:active,
#redo:active,
#eraser:active,
#straightLine:active {
  background-color: var(--secondary);
  fill: var(--purple2);
}

#fillTool svg:active,
#pencil svg:active,
#undo svg:active,
#redo svg:active,
#eraser svg:active,
#undo svg:active,
#straightLine svg:active {
  /* box-shadow: 0px 0px 1px 0.5px var(--purple); */
  /* background-color: var(--secondary); */
  fill: var(--purple);
}

#paletteToggle {
  /* display: flex; */
  align-items: center;
  justify-content: center;
  cursor: pointer;
  position: relative;
  margin-left: 0.2rem;

  width: 5.7rem;
  height: 5.7rem;
  /* /* padding: 1px; */
  /* margin-top: -0.3rem;
  margin-left: -0.4em;  */
  /* margin-right: 0.25em; */

  /* border: var(--secondary) 2px solid; */
  background-color: transparent;
  border: transparent 2px solid;
}

#paletteToggle svg {
  /* margin: auto; */
  justify-content: center;
  width: 5.7rem;
  height: 5.7rem;
  margin-top: -0.4rem;
  margin-left: -0.6em;
  margin-right: -0.6rem;
  margin-bottom: -0.5rem;

  /* color: red;
  fill: red; */
  fill: var(--secondary);
}

#paletteToggle:hover {
  background-color: var(--purple2);
}

#paletteToggle:active {
  background-color: var(--secondary);
  fill: var(--purple2);
}

#paletteToggle svg:active {
  fill: var(--purple);
}

.palette-grid {
  display: grid;
  grid-template-columns: repeat(10, 22px);
  grid-auto-rows: 22px;
  /* optional padding if you want a little breathing room */
  /* padding: 2px; */
}

.colorpalette-full {
  display: block;
}

.colorpalette-condensed {
  overflow: visible;
  display: none;
  position: relative;
  flex: 0 0 auto;
}

.colorpalette-condensed .dropdown {
  /* overflow: visible; */
  display: none;
  position: absolute;
  top: 100%;
  left: 0;
  background: white;
  border: 1px solid gray;
  z-index: 150;
  width: max-content;
  /* min-width: 260px; */
}

.colorpalette-condensed.active .dropdown {
  overflow: visible;
  display: grid;
}

#colorpalette {
  display: grid;
  grid-template-columns: repeat(10, 25px);
  grid-template-rows: repeat(3, 25px);
  /* gap:1px; */
  /* padding-top: 2.5px; */
  /* margin-top: -.1rem; */

  margin-left: -0.07rem;
  margin-left: 0.15rem;

  position: relative;
  overflow: visible;
}

.swatch {
  /* box-sizing:border-box; */
  border: 0px solid var(--background);
  outline: 1px solid var(--secondary);
  cursor: pointer;
  /* overflow: visible; */
  margin-left: 1.5px;
  margin-top: 1.5px;
  margin-bottom: 1.5px;
  margin-right: 1.5px;
}

.swatch:hover {
  overflow: visible;
  outline: 1px solid #b217fb;
}

.swatchEdit {
  /* box-sizing:border-box; */
  border: 0px solid var(--background);
  outline: 1px solid var(--secondary);
  cursor: pointer;
  /* overflow: visible; */
  margin-left: 1.5px;
  margin-top: 1.5px;
  margin-bottom: 1.5px;
  margin-right: 1.5px;
}

.adjuster {
  background-color: var(--background);
  width: 5px;
  height: 5px;
  position: absolute;
  border: var(--secondary) solid 2px;
  /* border-radius: 50% 50%; */
  cursor: pointer;
  z-index: 2;
}

.adjuster.centerBox {
  background-color: var(--background);
  width: 5px;
  height: 5px;
  position: absolute;
  border: var(--secondary) solid 2px;
  /* border-radius: 50% 50%; */
  cursor: pointer;
  z-index: 1;
}

.previewAdjuster {
  /* image-rendering: pixelated; */
  /* shape-rendering: crispEdges; */
  /* vector-effect: non-scaling-stroke; */
  position: absolute;
  pointer-events: none;
}

#mainbody {
  margin: 0;
  display: grid;
  height: calc(100svh - var(--toolheight) - var(--statusheight));
  grid-template-columns: auto 1fr;
  grid-template-rows: auto 1fr;
}

#statusbar {
  height: var(--statusheight);
  padding: 0;
  background-color: transparent;
  width: 100svw;
  display: flex;
}

.statusbarValue {
  height: 100%;
  width: 12rem;
  font-size: 1rem;
  padding-right: 0.125rem;
  padding-left: 0.125rem;
  color: var(--secondary);
  font-weight: 500;
}

#completionbarContainer {
  border: var(--secondary) 1px solid;
  padding: 0;
  padding-bottom: 0.125rem;
}

#completionbar {
  height: 100%;
  width: 0%;
  background-color: var(--secondary);
  transition: width 0.2s ease-out; /* Adjust duration and easing as needed */
}

#top-ruler {
  grid-column: 2 / 3;
  grid-row: 1 / 2;
  background-color: transparent;
  height: var(--rulerheight);
  display: flex;
  padding: 0;
  width: 100%;
  position: relative;
}

#left-ruler {
  grid-column: 1 / 2;
  grid-row: 2 / 3;
  background-color: transparent;
  width: var(--rulerheight);
  display: flex;
  flex-direction: column;
  padding: 0;
  height: 100%;
  position: relative;
}

.topSegment {
  border-right: var(--secondary) 1px solid;
  flex-shrink: 0;
}

.topNumber {
  height: 75%;
  width: 100%;
  font-size: 0.75rem;
  font-weight: 500;
  color: var(--secondary);
}

.topTick {
  height: 25%;
  width: 100%;
  display: flex;
  padding: 0;
}

.topSubtick {
  width: 10%;
  height: 100%;
  border-right: var(--secondary) 1px solid;
  box-sizing: border-box;
}

.topSubtick:last-child {
  border-right: var(--secondary) 0px solid;
}

#topIndicator {
  position: absolute;
  height: 100%;
  border-right: var(--secondary) 1px solid;
}

#leftIndicator {
  position: absolute;
  width: 100%;
  border-bottom: var(--secondary) 1px solid;
}

.leftSegment {
  border-bottom: var(--secondary) 1px solid;
  display: flex;
  flex-shrink: 0;
}

.leftNumber {
  height: 100%;
  width: 75%;
  font-size: 0.75rem;
  font-weight: 500;
  color: var(--secondary);
  writing-mode: sideways-lr;
  text-align: right;
}

.leftTick {
  height: 100%;
  width: 25%;
  padding: 0;
}

.leftSubtick {
  width: 100%;
  height: 10%;
  border-bottom: var(--secondary) 1px solid;
  box-sizing: border-box;
}

.leftSubtick:last-child {
  border-bottom: var(--secondary) 0px solid;
}

/* 
idk why but I think its important to keep track of z-indexes/z-indices
not sure if there is an easy way to automate this but im lazy and just going to leave this here

Below is an attempt to keep track of the z-indexes/z-indices
It follows the format of:

  (file/location): 
    (place/section) => (z-index/zIndex value)



 z-index/zIndex records: 
  styles.css:
    #toolbar => 100
    #toolbar-left => 101
    #userList => 90
    .actual-dropdown-list-brushsize-box => 70
    #main-tools => 80
    .colorpalette-condensed .dropdown => 10

  cursorManager.js: 
    makeEraserSquare() => 50


*/
@media (max-width: 885px) {
  .custom-dropdown-username-box {
    width: 9rem;
  }
}
@media (max-width: 875px) {
  #colorpalette.colorpalette-full {
    display: none; /* !important */
  }
  .colorpalette-condensed {
    display: block;
  }
}
@media (max-width: 391px) {
  #toolbar-left {
  padding-left: 1rem;
}
  
}